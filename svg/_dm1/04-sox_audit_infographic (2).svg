<svg viewBox="0 0 1200 900" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <linearGradient id="excelGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#217346;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#185c37;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="pluginGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#3498db;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#2980b9;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="aiGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#9b59b6;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#8e44ad;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="benefitGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#27ae60;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#229954;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="headerGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#2c3e50;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#34495e;stop-opacity:1" />
    </linearGradient>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="3" dy="3" stdDeviation="4" flood-color="#00000030"/>
    </filter>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#2c3e50" />
    </marker>
    <marker id="dataFlow" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#e74c3c" />
    </marker>
  </defs>

  <!-- Background -->
  <rect width="1200" height="900" fill="#ecf0f1"/>

  <!-- Header -->
  <rect x="0" y="0" width="1200" height="70" fill="url(#headerGrad)"/>
  <text x="600" y="30" text-anchor="middle" fill="white" font-size="22" font-weight="bold" font-family="Arial">Hybrid SOX Solution: Excel + Custom Audit Plugin + MCP AI Server</text>
  <text x="600" y="50" text-anchor="middle" fill="white" font-size="14" font-family="Arial">Addressing Vendor Lock-in, Cost Escalation &amp; Training Fatigue</text>

  <!-- Architecture Overview -->
  <text x="600" y="95" text-anchor="middle" fill="#2c3e50" font-size="16" font-weight="bold" font-family="Arial">PROPOSED ARCHITECTURE</text>

  <!-- Excel Layer -->
  <rect x="50" y="120" width="300" height="200" rx="15" fill="url(#excelGrad)" filter="url(#shadow)"/>
  <text x="200" y="145" text-anchor="middle" fill="white" font-size="16" font-weight="bold" font-family="Arial">EXCEL FRONTEND</text>
  <text x="200" y="165" text-anchor="middle" fill="white" font-size="12" font-family="Arial">(Familiar Interface)</text>

  <!-- Excel Features -->
  <rect x="70" y="180" width="260" height="120" rx="8" fill="rgba(255,255,255,0.9)"/>
  <text x="80" y="200" fill="#2c3e50" font-size="11" font-weight="bold" font-family="Arial">✓ Same Excel UI users love</text>
  <text x="80" y="215" fill="#2c3e50" font-size="11" font-weight="bold" font-family="Arial">✓ No new training required</text>
  <text x="80" y="230" fill="#2c3e50" font-size="11" font-weight="bold" font-family="Arial">✓ Familiar formulas &amp; functions</text>
  <text x="80" y="245" fill="#2c3e50" font-size="11" font-weight="bold" font-family="Arial">✓ Easy data entry &amp; manipulation</text>
  <text x="80" y="260" fill="#2c3e50" font-size="11" font-weight="bold" font-family="Arial">✓ Works offline</text>
  <text x="80" y="275" fill="#2c3e50" font-size="11" font-weight="bold" font-family="Arial">✓ Export/import capabilities</text>
  <text x="80" y="290" fill="#2c3e50" font-size="11" font-weight="bold" font-family="Arial">✓ Existing templates preserved</text>

  <!-- Custom Plugin Layer -->
  <rect x="450" y="120" width="300" height="200" rx="15" fill="url(#pluginGrad)" filter="url(#shadow)"/>
  <text x="600" y="145" text-anchor="middle" fill="white" font-size="16" font-weight="bold" font-family="Arial">CUSTOM AUDIT PLUGIN</text>
  <text x="600" y="165" text-anchor="middle" fill="white" font-size="12" font-family="Arial">(Enterprise Controls)</text>

  <!-- Plugin Features -->
  <rect x="470" y="180" width="260" height="120" rx="8" fill="rgba(255,255,255,0.9)"/>
  <text x="480" y="200" fill="#2c3e50" font-size="11" font-weight="bold" font-family="Arial">✓ Complete audit trail logging</text>
  <text x="480" y="215" fill="#2c3e50" font-size="11" font-weight="bold" font-family="Arial">✓ Cell-level change tracking</text>
  <text x="480" y="230" fill="#2c3e50" font-size="11" font-weight="bold" font-family="Arial">✓ Digital signatures &amp; timestamps</text>
  <text x="480" y="245" fill="#2c3e50" font-size="11" font-weight="bold" font-family="Arial">✓ Role-based access controls</text>
  <text x="480" y="260" fill="#2c3e50" font-size="11" font-weight="bold" font-family="Arial">✓ Workflow automation</text>
  <text x="480" y="275" fill="#2c3e50" font-size="11" font-weight="bold" font-family="Arial">✓ Version control &amp; backup</text>
  <text x="480" y="290" fill="#2c3e50" font-size="11" font-weight="bold" font-family="Arial">✓ Evidence attachment system</text>

  <!-- AI/MCP Server Layer -->
  <rect x="850" y="120" width="300" height="200" rx="15" fill="url(#aiGrad)" filter="url(#shadow)"/>
  <text x="1000" y="145" text-anchor="middle" fill="white" font-size="16" font-weight="bold" font-family="Arial">MCP AI SERVER</text>
  <text x="1000" y="165" text-anchor="middle" fill="white" font-size="12" font-family="Arial">(Automated Intelligence)</text>

  <!-- AI Features -->
  <rect x="870" y="180" width="260" height="120" rx="8" fill="rgba(255,255,255,0.9)"/>
  <text x="880" y="200" fill="#2c3e50" font-size="11" font-weight="bold" font-family="Arial">✓ Automated test evidence</text>
  <text x="880" y="215" fill="#2c3e50" font-size="11" font-weight="bold" font-family="Arial">✓ ERP system integration</text>
  <text x="880" y="230" fill="#2c3e50" font-size="11" font-weight="bold" font-family="Arial">✓ Statistical sampling</text>
  <text x="880" y="245" fill="#2c3e50" font-size="11" font-weight="bold" font-family="Arial">✓ Risk scoring algorithms</text>
  <text x="880" y="260" fill="#2c3e50" font-size="11" font-weight="bold" font-family="Arial">✓ Exception identification</text>
  <text x="880" y="275" fill="#2c3e50" font-size="11" font-weight="bold" font-family="Arial">✓ Compliance reporting</text>
  <text x="880" y="290" fill="#2c3e50" font-size="11" font-weight="bold" font-family="Arial">✓ Trend analysis</text>

  <!-- Data Flow Arrows -->
  <line x1="350" y1="220" x2="450" y2="220" stroke="#e74c3c" stroke-width="3" marker-end="url(#dataFlow)"/>
  <line x1="750" y1="220" x2="850" y2="220" stroke="#e74c3c" stroke-width="3" marker-end="url(#dataFlow)"/>
  <line x1="850" y1="240" x2="750" y2="240" stroke="#27ae60" stroke-width="3" marker-end="url(#arrowhead)"/>
  <line x1="450" y1="260" x2="350" y2="260" stroke="#27ae60" stroke-width="3" marker-end="url(#arrowhead)"/>

  <!-- Data Flow Labels -->
  <text x="400" y="210" text-anchor="middle" fill="#e74c3c" font-size="10" font-weight="bold" font-family="Arial">User Actions</text>
  <text x="800" y="210" text-anchor="middle" fill="#e74c3c" font-size="10" font-weight="bold" font-family="Arial">Requests</text>
  <text x="800" y="255" text-anchor="middle" fill="#27ae60" font-size="10" font-weight="bold" font-family="Arial">AI Results</text>
  <text x="400" y="275" text-anchor="middle" fill="#27ae60" font-size="10" font-weight="bold" font-family="Arial">Audit Data</text>

  <!-- Technical Implementation -->
  <rect x="50" y="350" width="1100" height="180" rx="15" fill="#ffffff" stroke="#bdc3c7" stroke-width="2" filter="url(#shadow)"/>
  <text x="600" y="375" text-anchor="middle" fill="#2c3e50" font-size="16" font-weight="bold" font-family="Arial">TECHNICAL IMPLEMENTATION DETAILS</text>

  <!-- Plugin Architecture -->
  <rect x="70" y="390" width="350" height="120" rx="8" fill="#f8f9fa" stroke="#3498db" stroke-width="2"/>
  <text x="245" y="410" text-anchor="middle" fill="#3498db" font-size="14" font-weight="bold" font-family="Arial">EXCEL PLUGIN (VSTO/Office.js)</text>
  <text x="80" y="430" fill="#2c3e50" font-size="10" font-family="Arial">• Ribbon interface for SOX functions</text>
  <text x="80" y="445" fill="#2c3e50" font-size="10" font-family="Arial">• Background service for change tracking</text>
  <text x="80" y="460" fill="#2c3e50" font-size="10" font-family="Arial">• Local SQLite DB for audit logs</text>
  <text x="80" y="475" fill="#2c3e50" font-size="10" font-family="Arial">• Encrypted communication to MCP server</text>
  <text x="80" y="490" fill="#2c3e50" font-size="10" font-family="Arial">• Digital certificate management</text>

  <!-- MCP Server Details -->
  <rect x="450" y="390" width="350" height="120" rx="8" fill="#f8f9fa" stroke="#9b59b6" stroke-width="2"/>
  <text x="625" y="410" text-anchor="middle" fill="#9b59b6" font-size="14" font-weight="bold" font-family="Arial">MCP SERVER CAPABILITIES</text>
  <text x="460" y="430" fill="#2c3e50" font-size="10" font-family="Arial">• REST API for Excel plugin integration</text>
  <text x="460" y="445" fill="#2c3e50" font-size="10" font-family="Arial">• LLM-powered test automation</text>
  <text x="460" y="460" fill="#2c3e50" font-size="10" font-family="Arial">• Database connectors (SAP, Oracle, etc.)</text>
  <text x="460" y="475" fill="#2c3e50" font-size="10" font-family="Arial">• Document OCR and analysis</text>
  <text x="460" y="490" fill="#2c3e50" font-size="10" font-family="Arial">• Statistical sampling algorithms</text>

  <!-- Infrastructure -->
  <rect x="830" y="390" width="300" height="120" rx="8" fill="#f8f9fa" stroke="#27ae60" stroke-width="2"/>
  <text x="980" y="410" text-anchor="middle" fill="#27ae60" font-size="14" font-weight="bold" font-family="Arial">INFRASTRUCTURE</text>
  <text x="840" y="430" fill="#2c3e50" font-size="10" font-family="Arial">• On-premise or private cloud</text>
  <text x="840" y="445" fill="#2c3e50" font-size="10" font-family="Arial">• Full data sovereignty</text>
  <text x="840" y="460" fill="#2c3e50" font-size="10" font-family="Arial">• No vendor dependencies</text>
  <text x="840" y="475" fill="#2c3e50" font-size="10" font-family="Arial">• Scalable compute resources</text>
  <text x="840" y="490" fill="#2c3e50" font-size="10" font-family="Arial">• Enterprise security controls</text>

  <!-- Example Workflow -->
  <rect x="50" y="560" width="1100" height="160" rx="15" fill="#ffffff" stroke="#bdc3c7" stroke-width="2" filter="url(#shadow)"/>
  <text x="600" y="585" text-anchor="middle" fill="#2c3e50" font-size="16" font-weight="bold" font-family="Arial">EXAMPLE: AUTOMATED 3-WAY MATCH TESTING</text>

  <!-- Workflow Steps -->
  <rect x="70" y="600" width="200" height="100" rx="8" fill="#e8f5e8" stroke="#27ae60" stroke-width="2"/>
  <text x="170" y="620" text-anchor="middle" fill="#27ae60" font-size="12" font-weight="bold" font-family="Arial">1. USER REQUEST</text>
  <text x="80" y="640" fill="#2c3e50" font-size="9" font-family="Arial">User clicks "Test Controls"</text>
  <text x="80" y="653" fill="#2c3e50" font-size="9" font-family="Arial">in Excel SOX ribbon</text>
  <text x="80" y="666" fill="#2c3e50" font-size="9" font-family="Arial">Plugin captures request</text>
  <text x="80" y="679" fill="#2c3e50" font-size="9" font-family="Arial">with user credentials</text>
  <text x="80" y="692" fill="#2c3e50" font-size="9" font-family="Arial">and control parameters</text>

  <rect x="300" y="600" width="200" height="100" rx="8" fill="#e8f4fd" stroke="#3498db" stroke-width="2"/>
  <text x="400" y="620" text-anchor="middle" fill="#3498db" font-size="12" font-weight="bold" font-family="Arial">2. AI PROCESSING</text>
  <text x="310" y="640" fill="#2c3e50" font-size="9" font-family="Arial">MCP server receives</text>
  <text x="310" y="653" fill="#2c3e50" font-size="9" font-family="Arial">control testing request</text>
  <text x="310" y="666" fill="#2c3e50" font-size="9" font-family="Arial">Connects to ERP system</text>
  <text x="310" y="679" fill="#2c3e50" font-size="9" font-family="Arial">Performs statistical sampling</text>
  <text x="310" y="692" fill="#2c3e50" font-size="9" font-family="Arial">Validates 3-way matches</text>

  <rect x="530" y="600" width="200" height="100" rx="8" fill="#fdf2e9" stroke="#e67e22" stroke-width="2"/>
  <text x="630" y="620" text-anchor="middle" fill="#e67e22" font-size="12" font-weight="bold" font-family="Arial">3. EVIDENCE CAPTURE</text>
  <text x="540" y="640" fill="#2c3e50" font-size="9" font-family="Arial">Screenshots of approvals</text>
  <text x="540" y="653" fill="#2c3e50" font-size="9" font-family="Arial">Digital signatures verified</text>
  <text x="540" y="666" fill="#2c3e50" font-size="9" font-family="Arial">Exception reports generated</text>
  <text x="540" y="679" fill="#2c3e50" font-size="9" font-family="Arial">Compliance scores calculated</text>
  <text x="540" y="692" fill="#2c3e50" font-size="9" font-family="Arial">All evidence timestamped</text>

  <rect x="760" y="600" width="200" height="100" rx="8" fill="#f4ecf7" stroke="#8e44ad" stroke-width="2"/>
  <text x="860" y="620" text-anchor="middle" fill="#8e44ad" font-size="12" font-weight="bold" font-family="Arial">4. RESULTS IN EXCEL</text>
  <text x="770" y="640" fill="#2c3e50" font-size="9" font-family="Arial">Test results populate</text>
  <text x="770" y="653" fill="#2c3e50" font-size="9" font-family="Arial">directly in Excel cells</text>
  <text x="770" y="666" fill="#2c3e50" font-size="9" font-family="Arial">Evidence links embedded</text>
  <text x="770" y="679" fill="#2c3e50" font-size="9" font-family="Arial">Audit trail logged</text>
  <text x="770" y="692" fill="#2c3e50" font-size="9" font-family="Arial">User sees familiar format</text>

  <rect x="990" y="600" width="160" height="100" rx="8" fill="#eaf2f8" stroke="#2980b9" stroke-width="2"/>
  <text x="1070" y="620" text-anchor="middle" fill="#2980b9" font-size="12" font-weight="bold" font-family="Arial">5. AUDIT READY</text>
  <text x="1000" y="640" fill="#2c3e50" font-size="9" font-family="Arial">Complete audit trail</text>
  <text x="1000" y="653" fill="#2c3e50" font-size="9" font-family="Arial">Digital signatures</text>
  <text x="1000" y="666" fill="#2c3e50" font-size="9" font-family="Arial">Evidence package</text>
  <text x="1000" y="679" fill="#2c3e50" font-size="9" font-family="Arial">Compliance report</text>
  <text x="1000" y="692" fill="#2c3e50" font-size="9" font-family="Arial">External auditor</text>

  <!-- Workflow Arrows -->
  <line x1="270" y1="650" x2="300" y2="650" stroke="#2c3e50" stroke-width="2" marker-end="url(#arrowhead)"/>
  <line x1="500" y1="650" x2="530" y2="650" stroke="#2c3e50" stroke-width="2" marker-end="url(#arrowhead)"/>
  <line x1="730" y1="650" x2="760" y2="650" stroke="#2c3e50" stroke-width="2" marker-end="url(#arrowhead)"/>
  <line x1="960" y1="650" x2="990" y2="650" stroke="#2c3e50" stroke-width="2" marker-end="url(#arrowhead)"/>

  <!-- Benefits Section -->
  <rect x="50" y="750" width="1100" height="120" rx="15" fill="url(#benefitGrad)" filter="url(#shadow)"/>
  <text x="600" y="775" text-anchor="middle" fill="white" font-size="16" font-weight="bold" font-family="Arial">KEY BENEFITS OF THIS HYBRID APPROACH</text>

  <rect x="70" y="790" width="270" height="70" rx="5" fill="rgba(255,255,255,0.9)"/>
  <text x="205" y="810" text-anchor="middle" fill="#27ae60" font-size="12" font-weight="bold" font-family="Arial">COST CONTROL</text>
  <text x="80" y="825" fill="#2c3e50" font-size="10" font-family="Arial">• No per-user licensing fees</text>
  <text x="80" y="838" fill="#2c3e50" font-size="10" font-family="Arial">• One-time development cost</text>
  <text x="80" y="851" fill="#2c3e50" font-size="10" font-family="Arial">• No vendor lock-in or price escalation</text>

  <rect x="360" y="790" width="270" height="70" rx="5" fill="rgba(255,255,255,0.9)"/>
  <text x="495" y="810" text-anchor="middle" fill="#27ae60" font-size="12" font-weight="bold" font-family="Arial">ZERO TRAINING</text>
  <text x="370" y="825" fill="#2c3e50" font-size="10" font-family="Arial">• Same Excel interface</text>
  <text x="370" y="838" fill="#2c3e50" font-size="10" font-family="Arial">• Existing workflows preserved</text>
  <text x="370" y="851" fill="#2c3e50" font-size="10" font-family="Arial">• Gradual feature adoption</text>

  <rect x="650" y="790" width="270" height="70" rx="5" fill="rgba(255,255,255,0.9)"/>
  <text x="785" y="810" text-anchor="middle" fill="#27ae60" font-size="12" font-weight="bold" font-family="Arial">FUTURE-PROOF</text>
  <text x="660" y="825" fill="#2c3e50" font-size="10" font-family="Arial">• Own the technology stack</text>
  <text x="660" y="838" fill="#2c3e50" font-size="10" font-family="Arial">• No vendor dependency</text>
  <text x="660" y="851" fill="#2c3e50" font-size="10" font-family="Arial">• Customizable to exact needs</text>

  <rect x="940" y="790" width="190" height="70" rx="5" fill="rgba(255,255,255,0.9)"/>
  <text x="1035" y="810" text-anchor="middle" fill="#27ae60" font-size="12" font-weight="bold" font-family="Arial">AUDIT READY</text>
  <text x="950" y="825" fill="#2c3e50" font-size="10" font-family="Arial">• Enterprise-grade controls</text>
  <text x="950" y="838" fill="#2c3e50" font-size="10" font-family="Arial">• Complete audit trails</text>
  <text x="950" y="851" fill="#2c3e50" font-size="10" font-family="Arial">• AI-powered automation</text>

</svg>