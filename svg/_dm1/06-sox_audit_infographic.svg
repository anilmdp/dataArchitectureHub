<svg viewBox="0 0 1400 1000" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <linearGradient id="hopGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#FF6B35;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#E55A2B;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="datamartGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#2E8B57;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#228B22;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="rustGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#ce422b;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#a0321e;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="mcpGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#9b59b6;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#8e44ad;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="sourceGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#3498db;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#2980b9;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="biGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#e74c3c;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#c0392b;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="headerGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#2c3e50;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#34495e;stop-opacity:1" />
    </linearGradient>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="3" dy="3" stdDeviation="4" flood-color="#00000030"/>
    </filter>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#2c3e50" />
    </marker>
    <marker id="dataFlow" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#e74c3c" />
    </marker>
    <marker id="controlFlow" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#9b59b6" />
    </marker>
  </defs>

  <!-- Background -->
  <rect width="1400" height="1000" fill="#ecf0f1"/>

  <!-- Header -->
  <rect x="0" y="0" width="1400" height="70" fill="url(#headerGrad)"/>
  <text x="700" y="30" text-anchor="middle" fill="white" font-size="22" font-weight="bold" font-family="Arial">SOX Datamart Architecture: Apache Hop + MCP + Rust Integration</text>
  <text x="700" y="50" text-anchor="middle" fill="white" font-size="14" font-family="Arial">Template-Driven ETL • Centralized BI • Automated Sampling &amp; Testing</text>

  <!-- Data Sources Layer -->
  <rect x="50" y="100" width="1300" height="140" rx="15" fill="#ffffff" stroke="#bdc3c7" stroke-width="2" filter="url(#shadow)"/>
  <text x="700" y="125" text-anchor="middle" fill="#2c3e50" font-size="16" font-weight="bold" font-family="Arial">DATA SOURCES LAYER</text>

  <!-- ERP Systems -->
  <rect x="70" y="140" width="180" height="80" rx="8" fill="url(#sourceGrad)" filter="url(#shadow)"/>
  <text x="160" y="165" text-anchor="middle" fill="white" font-size="14" font-weight="bold" font-family="Arial">ERP SYSTEMS</text>
  <text x="80" y="185" fill="white" font-size="10" font-family="Arial">• SAP FI/CO</text>
  <text x="80" y="198" fill="white" font-size="10" font-family="Arial">• Oracle Financials</text>
  <text x="80" y="211" fill="white" font-size="10" font-family="Arial">• NetSuite</text>

  <!-- Financial Systems -->
  <rect x="270" y="140" width="180" height="80" rx="8" fill="url(#sourceGrad)" filter="url(#shadow)"/>
  <text x="360" y="165" text-anchor="middle" fill="white" font-size="14" font-weight="bold" font-family="Arial">FINANCIAL SYSTEMS</text>
  <text x="280" y="185" fill="white" font-size="10" font-family="Arial">• General Ledger</text>
  <text x="280" y="198" fill="white" font-size="10" font-family="Arial">• Accounts Payable</text>
  <text x="280" y="211" fill="white" font-size="10" font-family="Arial">• Treasury Systems</text>

  <!-- HR/Payroll -->
  <rect x="470" y="140" width="180" height="80" rx="8" fill="url(#sourceGrad)" filter="url(#shadow)"/>
  <text x="560" y="165" text-anchor="middle" fill="white" font-size="14" font-weight="bold" font-family="Arial">HR/PAYROLL</text>
  <text x="480" y="185" fill="white" font-size="10" font-family="Arial">• Workday</text>
  <text x="480" y="198" fill="white" font-size="10" font-family="Arial">• ADP</text>
  <text x="480" y="211" fill="white" font-size="10" font-family="Arial">• BambooHR</text>

  <!-- IT Systems -->
  <rect x="670" y="140" width="180" height="80" rx="8" fill="url(#sourceGrad)" filter="url(#shadow)"/>
  <text x="760" y="165" text-anchor="middle" fill="white" font-size="14" font-weight="bold" font-family="Arial">IT SYSTEMS</text>
  <text x="680" y="185" fill="white" font-size="10" font-family="Arial">• Active Directory</text>
  <text x="680" y="198" fill="white" font-size="10" font-family="Arial">• ServiceNow</text>
  <text x="680" y="211" fill="white" font-size="10" font-family="Arial">• Database Logs</text>

  <!-- Operational Systems -->
  <rect x="870" y="140" width="180" height="80" rx="8" fill="url(#sourceGrad)" filter="url(#shadow)"/>
  <text x="960" y="165" text-anchor="middle" fill="white" font-size="14" font-weight="bold" font-family="Arial">OPERATIONAL</text>
  <text x="880" y="185" fill="white" font-size="10" font-family="Arial">• CRM (Salesforce)</text>
  <text x="880" y="198" fill="white" font-size="10" font-family="Arial">• Supply Chain</text>
  <text x="880" y="211" fill="white" font-size="10" font-family="Arial">• E-commerce</text>

  <!-- Rust Web Server -->
  <rect x="1070" y="140" width="180" height="80" rx="8" fill="url(#rustGrad)" filter="url(#shadow)"/>
  <text x="1160" y="165" text-anchor="middle" fill="white" font-size="14" font-weight="bold" font-family="Arial">RUST WEB SERVER</text>
  <text x="1080" y="185" fill="white" font-size="10" font-family="Arial">• Excel/Sheets Data</text>
  <text x="1080" y="198" fill="white" font-size="10" font-family="Arial">• Audit Trail</text>
  <text x="1080" y="211" fill="white" font-size="10" font-family="Arial">• User Actions</text>

  <!-- ETL Orchestration Layer -->
  <rect x="50" y="270" width="650" height="180" rx="15" fill="#ffffff" stroke="#bdc3c7" stroke-width="2" filter="url(#shadow)"/>
  <text x="375" y="295" text-anchor="middle" fill="#2c3e50" font-size="16" font-weight="bold" font-family="Arial">ETL ORCHESTRATION LAYER</text>

  <!-- MCP Server -->
  <rect x="70" y="310" width="280" height="120" rx="8" fill="url(#mcpGrad)" filter="url(#shadow)"/>
  <text x="210" y="335" text-anchor="middle" fill="white" font-size="14" font-weight="bold" font-family="Arial">MCP AI SERVER</text>
  <text x="210" y="355" text-anchor="middle" fill="white" font-size="12" font-family="Arial">ETL Controller &amp; Orchestrator</text>

  <rect x="80" y="370" width="260" height="50" rx="5" fill="rgba(255,255,255,0.9)"/>
  <text x="90" y="385" fill="#2c3e50" font-size="10" font-weight="bold" font-family="Arial">✓ Template-driven job generation</text>
  <text x="90" y="398" fill="#2c3e50" font-size="10" font-weight="bold" font-family="Arial">✓ Sampling strategy automation</text>
  <text x="90" y="411" fill="#2c3e50" font-size="10" font-weight="bold" font-family="Arial">✓ Statistical sample size calculation</text>

  <!-- Apache Hop -->
  <rect x="370" y="310" width="280" height="120" rx="8" fill="url(#hopGrad)" filter="url(#shadow)"/>
  <text x="510" y="335" text-anchor="middle" fill="white" font-size="14" font-weight="bold" font-family="Arial">APACHE HOP</text>
  <text x="510" y="355" text-anchor="middle" fill="white" font-size="12" font-family="Arial">Template-Driven ETL Engine</text>

  <rect x="380" y="370" width="260" height="50" rx="5" fill="rgba(255,255,255,0.9)"/>
  <text x="390" y="385" fill="#2c3e50" font-size="10" font-weight="bold" font-family="Arial">✓ 100% metadata-driven pipelines</text>
  <text x="390" y="398" fill="#2c3e50" font-size="10" font-weight="bold" font-family="Arial">✓ Visual workflow designer</text>
  <text x="390" y="411" fill="#2c3e50" font-size="10" font-weight="bold" font-family="Arial">✓ 400+ built-in transforms</text>

  <!-- Control Intelligence Layer -->
  <rect x="750" y="270" width="600" height="180" rx="15" fill="#ffffff" stroke="#bdc3c7" stroke-width="2" filter="url(#shadow)"/>
  <text x="1050" y="295" text-anchor="middle" fill="#2c3e50" font-size="16" font-weight="bold" font-family="Arial">CONTROL INTELLIGENCE LAYER</text>

  <!-- Sampling Engine -->
  <rect x="770" y="310" width="180" height="50" rx="8" fill="#f39c12" filter="url(#shadow)"/>
  <text x="860" y="330" text-anchor="middle" fill="white" font-size="12" font-weight="bold" font-family="Arial">SAMPLING ENGINE</text>
  <text x="860" y="345" text-anchor="middle" fill="white" font-size="9" font-family="Arial">Statistical • Systematic • Judgmental</text>

  <!-- Risk Scoring -->
  <rect x="970" y="310" width="180" height="50" rx="8" fill="#e74c3c" filter="url(#shadow)"/>
  <text x="1060" y="330" text-anchor="middle" fill="white" font-size="12" font-weight="bold" font-family="Arial">RISK SCORING</text>
  <text x="1060" y="345" text-anchor="middle" fill="white" font-size="9" font-family="Arial">ML-based Risk Assessment</text>

  <!-- Test Automation -->
  <rect x="770" y="380" width="180" height="50" rx="8" fill="#27ae60" filter="url(#shadow)"/>
  <text x="860" y="400" text-anchor="middle" fill="white" font-size="12" font-weight="bold" font-family="Arial">TEST AUTOMATION</text>
  <text x="860" y="415" text-anchor="middle" fill="white" font-size="9" font-family="Arial">3-way Match • Bank Rec • JE</text>

  <!-- Evidence Collector -->
  <rect x="970" y="380" width="180" height="50" rx="8" fill="#8e44ad" filter="url(#shadow)"/>
  <text x="1060" y="400" text-anchor="middle" fill="white" font-size="12" font-weight="bold" font-family="Arial">EVIDENCE COLLECTOR</text>
  <text x="1060" y="415" text-anchor="middle" fill="white" font-size="9" font-family="Arial">Screenshots • Documents • API</text>

  <!-- SOX Datamart - Central Hub -->
  <rect x="400" y="480" width="600" height="150" rx="15" fill="url(#datamartGrad)" filter="url(#shadow)"/>
  <text x="700" y="505" text-anchor="middle" fill="white" font-size="18" font-weight="bold" font-family="Arial">SOX DATAMART</text>
  <text x="700" y="525" text-anchor="middle" fill="white" font-size="14" font-family="Arial">Central BI Hub &amp; Single Source of Truth</text>

  <!-- Datamart Components -->
  <rect x="420" y="540" width="160" height="70" rx="8" fill="rgba(255,255,255,0.9)"/>
  <text x="500" y="560" text-anchor="middle" fill="#2c3e50" font-size="12" font-weight="bold" font-family="Arial">STAGING LAYER</text>
  <text x="430" y="575" fill="#2c3e50" font-size="9" font-family="Arial">• Raw extracted data</text>
  <text x="430" y="588" fill="#2c3e50" font-size="9" font-family="Arial">• Data quality checks</text>
  <text x="430" y="601" fill="#2c3e50" font-size="9" font-family="Arial">• Lineage tracking</text>

  <rect x="600" y="540" width="160" height="70" rx="8" fill="rgba(255,255,255,0.9)"/>
  <text x="680" y="560" text-anchor="middle" fill="#2c3e50" font-size="12" font-weight="bold" font-family="Arial">CONTROL DATA</text>
  <text x="610" y="575" fill="#2c3e50" font-size="9" font-family="Arial">• Test samples</text>
  <text x="610" y="588" fill="#2c3e50" font-size="9" font-family="Arial">• Test results</text>
  <text x="610" y="601" fill="#2c3e50" font-size="9" font-family="Arial">• Exception tracking</text>

  <rect x="780" y="540" width="160" height="70" rx="8" fill="rgba(255,255,255,0.9)"/>
  <text x="860" y="560" text-anchor="middle" fill="#2c3e50" font-size="12" font-weight="bold" font-family="Arial">AUDIT TRAIL</text>
  <text x="790" y="575" fill="#2c3e50" font-size="9" font-family="Arial">• Change history</text>
  <text x="790" y="588" fill="#2c3e50" font-size="9" font-family="Arial">• User actions</text>
  <text x="790" y="601" fill="#2c3e50" font-size="9" font-family="Arial">• Evidence links</text>

  <!-- BI/Reporting Layer -->
  <rect x="50" y="660" width="1300" height="120" rx="15" fill="#ffffff" stroke="#bdc3c7" stroke-width="2" filter="url(#shadow)"/>
  <text x="700" y="685" text-anchor="middle" fill="#2c3e50" font-size="16" font-weight="bold" font-family="Arial">BI &amp; REPORTING LAYER</text>

  <!-- Dashboards -->
  <rect x="70" y="700" width="200" height="60" rx="8" fill="url(#biGrad)" filter="url(#shadow)"/>
  <text x="170" y="720" text-anchor="middle" fill="white" font-size="12" font-weight="bold" font-family="Arial">CONTROL DASHBOARDS</text>
  <text x="80" y="735" fill="white" font-size="9" font-family="Arial">• Real-time test status</text>
  <text x="80" y="748" fill="white" font-size="9" font-family="Arial">• Risk heat maps</text>

  <!-- Compliance Reports -->
  <rect x="290" y="700" width="200" height="60" rx="8" fill="url(#biGrad)" filter="url(#shadow)"/>
  <text x="390" y="720" text-anchor="middle" fill="white" font-size="12" font-weight="bold" font-family="Arial">COMPLIANCE REPORTS</text>
  <text x="300" y="735" fill="white" font-size="9" font-family="Arial">• SOX 404 readiness</text>
  <text x="300" y="748" fill="white" font-size="9" font-family="Arial">• Deficiency tracking</text>

  <!-- Analytics -->
  <rect x="510" y="700" width="200" height="60" rx="8" fill="url(#biGrad)" filter="url(#shadow)"/>
  <text x="610" y="720" text-anchor="middle" fill="white" font-size="12" font-weight="bold" font-family="Arial">PREDICTIVE ANALYTICS</text>
  <text x="520" y="735" fill="white" font-size="9" font-family="Arial">• Trend analysis</text>
  <text x="520" y="748" fill="white" font-size="9" font-family="Arial">• Risk forecasting</text>

  <!-- External Auditor Portal -->
  <rect x="730" y="700" width="200" height="60" rx="8" fill="url(#biGrad)" filter="url(#shadow)"/>
  <text x="830" y="720" text-anchor="middle" fill="white" font-size="12" font-weight="bold" font-family="Arial">AUDITOR PORTAL</text>
  <text x="740" y="735" fill="white" font-size="9" font-family="Arial">• Evidence packages</text>
  <text x="740" y="748" fill="white" font-size="9" font-family="Arial">• Testing documentation</text>

  <!-- API Layer -->
  <rect x="950" y="700" width="200" height="60" rx="8" fill="url(#biGrad)" filter="url(#shadow)"/>
  <text x="1050" y="720" text-anchor="middle" fill="white" font-size="12" font-weight="bold" font-family="Arial">API LAYER</text>
  <text x="960" y="735" fill="white" font-size="9" font-family="Arial">• RESTful APIs</text>
  <text x="960" y="748" fill="white" font-size="9" font-family="Arial">• Third-party integrations</text>

  <!-- Data Flow Arrows -->
  <!-- Sources to ETL -->
  <line x1="160" y1="220" x2="160" y2="270" stroke="#e74c3c" stroke-width="2" marker-end="url(#dataFlow)"/>
  <line x1="360" y1="220" x2="360" y2="270" stroke="#e74c3c" stroke-width="2" marker-end="url(#dataFlow)"/>
  <line x1="560" y1="220" x2="500" y2="270" stroke="#e74c3c" stroke-width="2" marker-end="url(#dataFlow)"/>
  <line x1="760" y1="220" x2="480" y2="270" stroke="#e74c3c" stroke-width="2" marker-end="url(#dataFlow)"/>
  <line x1="960" y1="220" x2="460" y2="270" stroke="#e74c3c" stroke-width="2" marker-end="url(#dataFlow)"/>
  <line x1="1160" y1="220" x2="440" y2="270" stroke="#e74c3c" stroke-width="2" marker-end="url(#dataFlow)"/>

  <!-- MCP to Hop Control -->
  <line x1="350" y1="370" x2="370" y2="370" stroke="#9b59b6" stroke-width="3" marker-end="url(#controlFlow)"/>

  <!-- ETL to Datamart -->
  <line x1="510" y1="430" x2="610" y2="480" stroke="#e74c3c" stroke-width="3" marker-end="url(#dataFlow)"/>

  <!-- Intelligence to Datamart -->
  <line x1="860" y1="430" x2="780" y2="480" stroke="#e74c3c" stroke-width="2" marker-end="url(#dataFlow)"/>
  <line x1="1060" y1="430" x2="820" y2="480" stroke="#e74c3c" stroke-width="2" marker-end="url(#dataFlow)"/>

  <!-- Datamart to BI -->
  <line x1="600" y1="630" x2="400" y2="660" stroke="#e74c3c" stroke-width="2" marker-end="url(#dataFlow)"/>
  <line x1="700" y1="630" x2="610" y2="660" stroke="#e74c3c" stroke-width="2" marker-end="url(#dataFlow)"/>
  <line x1="800" y1="630" x2="830" y2="660" stroke="#e74c3c" stroke-width="2" marker-end="url(#dataFlow)"/>

  <!-- Pros/Cons Analysis -->
  <rect x="50" y="810" width="1300" height="160" rx="15" fill="#ffffff" stroke="#bdc3c7" stroke-width="2" filter="url(#shadow)"/>
  <text x="700" y="835" text-anchor="middle" fill="#2c3e50" font-size="16" font-weight="bold" font-family="Arial">PROS, CONS &amp; SUITABILITY ANALYSIS</text>

  <!-- Pros -->
  <rect x="70" y="850" width="400" height="100" rx="8" fill="#d5f4e6" stroke="#27ae60" stroke-width="2"/>
  <text x="270" y="870" text-anchor="middle" fill="#27ae60" font-size="14" font-weight="bold" font-family="Arial">✓ PROS</text>
  <text x="80" y="885" fill="#2c3e50" font-size="10" font-family="Arial">• Template-driven ETL reduces development time 80%</text>
  <text x="80" y="898" fill="#2c3e50" font-size="10" font-family="Arial">• Apache Hop's 400+ transforms handle any data source</text>
  <text x="80" y="911" fill="#2c3e50" font-size="10" font-family="Arial">• MCP server provides intelligent sampling algorithms</text>
  <text x="80" y="924" fill="#2c3e50" font-size="10" font-family="Arial">• Single datamart = single source of truth for SOX</text>
  <text x="80" y="937" fill="#2c3e50" font-size="10" font-family="Arial">• Visual ETL designer empowers business users</text>

  <!-- Cons -->
  <rect x="490" y="850" width="400" height="100" rx="8" fill="#fdeaea" stroke="#e74c3c" stroke-width="2"/>
  <text x="690" y="870" text-anchor="middle" fill="#e74c3c" font-size="14" font-weight="bold" font-family="Arial">✗ CONS</text>
  <text x="500" y="885" fill="#2c3e50" font-size="10" font-family="Arial">• Apache Hop learning curve for IT team</text>
  <text x="500" y="898" fill="#2c3e50" font-size="10" font-family="Arial">• Additional infrastructure complexity</text>
  <text x="500" y="911" fill="#2c3e50" font-size="10" font-family="Arial">• Data governance overhead increases</text>
  <text x="500" y="924" fill="#2c3e50" font-size="10" font-family="Arial">• Requires robust backup/disaster recovery</text>
  <text x="500" y="937" fill="#2c3e50" font-size="10" font-family="Arial">• Performance tuning needed for large datasets</text>

  <!-- Suitability -->
  <rect x="910" y="850" width="420" height="100" rx="8" fill="#e8f4fd" stroke="#3498db" stroke-width="2"/>
  <text x="1120" y="870" text-anchor="middle" fill="#3498db" font-size="14" font-weight="bold" font-family="Arial">🎯 SUITABILITY</text>
  <text x="920" y="885" fill="#2c3e50" font-size="10" font-family="Arial">• Perfect for companies with 50+ controls to test</text>
  <text x="920" y="898" fill="#2c3e50" font-size="10" font-family="Arial">• Ideal when multiple IT systems need integration</text>
  <text x="920" y="911" fill="#2c3e50" font-size="10" font-family="Arial">• Best for organizations wanting data governance</text>
  <text x="920" y="924" fill="#2c3e50" font-size="10" font-family="Arial">• Suited for teams with ETL/BI experience</text>
  <text x="920" y="937" fill="#2c3e50" font-size="10" font-family="Arial">• Essential for multi-entity SOX compliance</text>

</svg>